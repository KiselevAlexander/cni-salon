"use strict";var parseQueryString=function(t){for(var e={},a=("?"===t[0]?t.substr(1):t).split("&"),r=0;r<a.length;r++){var n=a[r].split("=");n[0]&&n[1]&&(e[decodeURIComponent(n[0])]=decodeURIComponent(n[1]||""))}return e},queryData=parseQueryString(window.location.search);queryData.utm_campaign&&localStorage.setItem("metrics",JSON.stringify(queryData)),jQuery(function(t){var e;e="sub",console.log("test 2 "+e);var a,r,n,o,i,l=(r="/local/templates/2018/sendform.php ",n=8==(a=(/MSIE (\d+)\./.exec(navigator.userAgent)||[0,0])[1])||9==a&&"file:"!=location.protocol?function(e,a){var r=new XDomainRequest,n=t.Deferred();return r.open(a.type,e),r.onload=function(){n.resolve(this.responseText)},r.onerror=function(){n.reject()},r.send(a.data),n}:(t.support.cors=!0,t.ajax),o=function(t,e){return t="__"+t+"__",e.length?(this[t]=e[0],this):this[t]},(i=function(t){t=t||{},this.__email__=t.email||"",this.__title__=t.title||"",this.__data__=t.data||[]}).prototype.email=function(t){return o.call(this,"email",arguments)},i.prototype.title=function(t){return o.call(this,"title",arguments)},i.prototype.data=function(t){return o.call(this,"data",arguments)},i.prototype.send=function(e,a){var o,i,l,s=(o=t.Deferred(),i=this,l=["email","title","data","send"],t.each(l,function(t,e){o[e]=function(){return i[e].apply(i,arguments)}}),o);return a&&(a.call(this,s),"pending"!=s.state())?s:(n(r,{type:"POST",dataType:"json",data:{sendto:$("[data-form-sendto]").val(),product:$("[data-form-product]").val(),city:$('[name="city"]').val(),name:$('[name="name"]').val(),phone:$('[name="phone"]').val(),email:$('[name="email"]').val(),text:$('[name="message"]').val(),metrics:localStorage.getItem("metrics")}}).done(function(t){try{if(console.log(r),t.error?s.reject(t.error):s.resolve(t.response),window.yaCounter42617899.reachGoal("Order"),STORAGE_KEY){var e=localStorage.getItem(STORAGE_KEY);if(e){var a=JSON.parse(e);reachGoal(a.goal,a.metric),localStorage.removeItem(STORAGE_KEY)}}}catch(t){s.reject("Incorrect server response.")}}).fail(function(){var t="Failed to query the server. ";t+="onLine"in navigator&&!navigator.onLine?"No connection to the Internet.":"Check the connection and try again.",s.reject(t)}),s)},{Form:function(t){return new i(t)}});t('[data-form-type="formoid"]').each(function(){var e,a=t(this),r=a.is("form")?a:a.find("form"),n=a.find("[data-form-alert]"),o=a.is("[data-form-title]")?a:a.find("[data-form-title]"),i=a.find('[type="submit"]'),s=n.attr("data-success")||n.find("[data-form-alert-success]").html();i.html('<span class="btn-text">'+i.html()+'</span><i class="btn-loader"></i>').click(function(){r.addClass("form-active")}),r.submit(function(c){if(c.preventDefault(),r.addClass("form-active"),!i.hasClass("btn-loading")){var d=!0,f=[];e=e||l.Form({email:a.find("[data-form-email]").val(),title:o.attr("data-form-title")||o.text()}),n.html(""),a.find("[data-form-field]").each(function(){(function(e){if(e.checkValidity)return e.checkValidity();var a=!0,r=t(e).val(),n=t(e).attr("type");return r?a=!("email"===n&&!/^([^@]+?)@(([a-z0-9]-*)*[a-z0-9]+\.)+([a-z0-9]+)$/i.test(r)):t(e).attr("required")&&(a=!1),t(e)[(a?"remove":"add")+"Class"]("form-invalid"),a})(this)||(d=!1),f.push([t(this).attr("data-form-field")||t(this).attr("name"),t(this).val()])}),d&&(i.addClass("btn-loading").prop("disabled",!0),e.send(f).done(function(e){r.removeClass("form-active"),a.find("[data-form-field]").val(""),n.append(t('<div class="alert alert-form alert-success text-xs-center"/>').text(s||e))}).fail(function(e){n.append(t('<div class="alert alert-form alert-danger text-xs-center"/>').text(e))}).always(function(){i.removeClass("btn-loading").prop("disabled",!1)}))}})})});
//# sourceMappingURL=sendform.min.js.map
